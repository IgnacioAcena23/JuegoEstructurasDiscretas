<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prueba de Delay del Turno</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            padding: 20px; 
            background-color: #f5f5f5;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-section {
            background: #f8f9fa;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        button {
            background: #6f42c1;
            color: white;
            border: none;
            padding: 15px 30px;
            margin: 10px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
        }
        button:hover {
            background: #5a32a3;
        }
        .status {
            background: #e9ecef;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
        }
        .log {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 5px;
            padding: 15px;
            margin-top: 20px;
            max-height: 300px;
            overflow-y: auto;
            font-family: monospace;
            font-size: 12px;
        }
        .success { color: #28a745; }
        .error { color: #dc3545; }
        .warning { color: #ffc107; }
        .info { color: #17a2b8; }
        
        .simulation-section {
            background: #e3f2fd;
            border: 2px solid #2196f3;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .word-input {
            display: flex;
            gap: 10px;
            align-items: center;
            margin: 15px 0;
        }
        
        .word-input input {
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
            width: 200px;
        }
        
        .word-input button {
            background: #ff9800;
            padding: 10px 20px;
        }
        
        .word-input button:hover {
            background: #f57c00;
        }
        
        .score-display {
            background: #f8f9fa;
            border: 2px solid #28a745;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            text-align: center;
        }
        
        .score-value {
            font-size: 2em;
            font-weight: bold;
            color: #28a745;
        }
        
        .timeline {
            background: #f8f9fa;
            border: 2px solid #28a745;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
        }
        
        .timeline-item {
            display: flex;
            align-items: center;
            margin: 10px 0;
            padding: 10px;
            background: white;
            border-radius: 5px;
            border-left: 4px solid #ddd;
        }
        
        .timeline-item.active {
            border-left-color: #28a745;
            background: #f0f8f0;
        }
        
        .timeline-item.delayed {
            border-left-color: #ff9800;
            background: #fff8f0;
        }
        
        .timeline-time {
            font-weight: bold;
            margin-right: 15px;
            min-width: 80px;
        }
        
        .timeline-action {
            flex: 1;
        }
        
        .timeline-status {
            font-size: 12px;
            padding: 2px 8px;
            border-radius: 10px;
            color: white;
        }
        
        .status-success { background: #28a745; }
        .status-warning { background: #ff9800; }
        .status-info { background: #17a2b8; }
        
        .countdown {
            background: #e3f2fd;
            border: 2px solid #2196f3;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            text-align: center;
            font-size: 1.2em;
        }
        
        .countdown-value {
            font-size: 2.5em;
            font-weight: bold;
            color: #2196f3;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>‚è±Ô∏è Prueba de Delay del Turno</h1>
        <p>Esta p√°gina te permite probar el delay de 2 segundos que ocurre despu√©s de presionar "Jugar palabra" antes de mostrar el turno del siguiente jugador.</p>
        
        <div class="status">
            <h3>Estado de la Configuraci√≥n:</h3>
            <div id="config-status">Verificando...</div>
        </div>
        
        <div class="test-section">
            <h3>üéØ Pruebas de Delay</h3>
            <button onclick="testDelaySequence()">‚è±Ô∏è Probar Secuencia Completa</button>
            <button onclick="testDelayOnly()">‚è±Ô∏è Probar Solo el Delay</button>
            <button onclick="testImmediateTurn()">‚ö° Probar Turno Inmediato</button>
            <button onclick="clearTimeline()">üóëÔ∏è Limpiar Timeline</button>
            
            <div id="test-result"></div>
        </div>
        
        <div class="simulation-section">
            <h3>üéÆ Simulaci√≥n de Juego</h3>
            <p>Simula el proceso completo: Palabra v√°lida ‚Üí Delay 2s ‚Üí Turno siguiente</p>
            
            <div class="word-input">
                <input type="text" id="word-input" placeholder="Escribe una palabra" maxlength="7">
                <button onclick="simulateValidWord()">üéØ Simular Palabra V√°lida</button>
            </div>
            
            <div class="score-display">
                <div>Puntuaci√≥n Simulada:</div>
                <div class="score-value" id="score-display">0</div>
            </div>
            
            <div class="countdown" id="countdown" style="display: none;">
                <div>Esperando para mostrar turno del siguiente jugador:</div>
                <div class="countdown-value" id="countdown-value">2</div>
                <div>segundos</div>
            </div>
            
            <div id="simulation-result"></div>
        </div>
        
        <div class="timeline">
            <h3>üìÖ Timeline de Eventos</h3>
            <div id="timeline-content">
                <div class="timeline-item">
                    <div class="timeline-time">0s</div>
                    <div class="timeline-action">Inicio de la prueba</div>
                    <div class="timeline-status status-info">Listo</div>
                </div>
            </div>
        </div>
        
        <div class="log">
            <strong>Logs de Consola:</strong>
            <div id="log-content">
                Los logs aparecer√°n aqu√≠...
            </div>
        </div>
    </div>
    
    <!-- Scripts -->
    <script src="javaScript/config.js"></script>
    
    <script>
        // Simular estado del juego para las pruebas
        const gameState = {
            currentPlayer: 0,
            score: 0,
            wordCount: 0
        };
        
        // Funci√≥n para agregar logs a la interfaz
        function addLog(message, type = 'log') {
            const logContent = document.getElementById('log-content');
            const timestamp = new Date().toLocaleTimeString();
            const className = type === 'error' ? 'error' : type === 'warn' ? 'warning' : type === 'info' ? 'info' : 'success';
            logContent.innerHTML += `<span class="${className}">[${timestamp}] ${message}</span><br>`;
            logContent.scrollTop = logContent.scrollHeight;
        }
        
        // Interceptar console.log para mostrar en la interfaz
        const originalLog = console.log;
        const originalError = console.error;
        const originalWarn = console.warn;
        
        console.log = function(...args) {
            originalLog.apply(console, args);
            addLog('LOG: ' + args.join(' '), 'log');
        };
        
        console.error = function(...args) {
            originalError.apply(console, args);
            addLog('ERROR: ' + args.join(' '), 'error');
        };
        
        console.warn = function(...args) {
            originalWarn.apply(console, args);
            addLog('WARN: ' + args.join(' '), 'warning');
        };
        
        // Funci√≥n para simular la secuencia completa del delay
        function testDelaySequence() {
            console.log('‚è±Ô∏è Probando secuencia completa del delay...');
            const resultDiv = document.getElementById('test-result');
            resultDiv.innerHTML = '<span style="color: #6f42c1;">üîÑ Probando secuencia completa...</span>';
            
            // Limpiar timeline
            clearTimeline();
            
            // Simular palabra v√°lida
            updateTimeline('word-valid', 'Palabra v√°lida formada', 'success');
            
            // Simular audio CorrectWord.mp3
            setTimeout(() => {
                console.log('üéµ Reproduciendo audio CorrectWord.mp3...');
                if (typeof playAudio === 'function') {
                    playAudio('correct_word');
                    updateTimeline('audio-correct', 'Audio CorrectWord.mp3 reproducido', 'success');
                }
            }, 500);
            
            // Simular mensaje de √©xito
            setTimeout(() => {
                console.log('‚úÖ Mostrando mensaje de √©xito');
                updateTimeline('message-success', 'Mensaje de √©xito mostrado', 'success');
            }, 1000);
            
            // Simular reposici√≥n de fichas
            setTimeout(() => {
                console.log('üß© Reponiendo fichas del jugador');
                updateTimeline('replenish-tiles', 'Fichas repuestas', 'success');
            }, 1200);
            
            // Simular delay de 2 segundos
            setTimeout(() => {
                console.log('‚è±Ô∏è Esperando 2 segundos antes de mostrar el turno del siguiente jugador...');
                updateTimeline('delay-start', 'Iniciando delay de 2 segundos', 'warning');
                
                // Mostrar countdown
                showCountdown();
                
                // Despu√©s de 2 segundos, pasar al siguiente jugador
                setTimeout(() => {
                    console.log('üîÑ Pasando al siguiente jugador despu√©s del delay...');
                    updateTimeline('delay-end', 'Delay completado, pasando al siguiente jugador', 'success');
                    
                    // Simular cambio de turno
                    gameState.currentPlayer = gameState.currentPlayer === 0 ? 1 : 0;
                    console.log(`üë§ Turno cambiado a: Jugador ${gameState.currentPlayer + 1}`);
                    
                    // Simular audio PlayerTurn.mp3
                    if (typeof playAudio === 'function') {
                        playAudio('player_turn');
                        updateTimeline('audio-turn', 'Audio PlayerTurn.mp3 reproducido', 'success');
                    }
                    
                    resultDiv.innerHTML = '<span style="color: #28a745;">‚úÖ Secuencia completa probada (delay de 2s funcionando)</span>';
                    hideCountdown();
                }, 2000);
                
            }, 1500);
        }
        
        // Funci√≥n para probar solo el delay
        function testDelayOnly() {
            console.log('‚è±Ô∏è Probando solo el delay...');
            const resultDiv = document.getElementById('test-result');
            resultDiv.innerHTML = '<span style="color: #ff9800;">‚è±Ô∏è Probando delay de 2 segundos...</span>';
            
            updateTimeline('delay-test', 'Iniciando prueba de delay', 'info');
            
            // Simular delay de 2 segundos
            setTimeout(() => {
                console.log('‚úÖ Delay de 2 segundos completado');
                updateTimeline('delay-complete', 'Delay de 2 segundos completado', 'success');
                resultDiv.innerHTML = '<span style="color: #28a745;">‚úÖ Delay de 2 segundos probado correctamente</span>';
            }, 2000);
        }
        
        // Funci√≥n para probar turno inmediato (sin delay)
        function testImmediateTurn() {
            console.log('‚ö° Probando turno inmediato...');
            const resultDiv = document.getElementById('test-result');
            resultDiv.innerHTML = '<span style="color: #17a2b8;">‚ö° Probando turno inmediato...</span>';
            
            updateTimeline('immediate-turn', 'Turno inmediato (sin delay)', 'info');
            
            // Simular cambio de turno inmediato
            gameState.currentPlayer = gameState.currentPlayer === 0 ? 1 : 0;
            console.log(`üë§ Turno cambiado inmediatamente a: Jugador ${gameState.currentPlayer + 1}`);
            
            // Simular audio PlayerTurn.mp3
            if (typeof playAudio === 'function') {
                playAudio('player_turn');
                updateTimeline('audio-immediate', 'Audio PlayerTurn.mp3 reproducido inmediatamente', 'success');
            }
            
            resultDiv.innerHTML = '<span style="color: #28a745;">‚úÖ Turno inmediato probado correctamente</span>';
        }
        
        // Funci√≥n para simular una palabra v√°lida con delay
        function simulateValidWord() {
            const wordInput = document.getElementById('word-input');
            const word = wordInput.value.trim().toUpperCase();
            
            if (word.length === 0) {
                alert('Por favor, escribe una palabra');
                return;
            }
            
            console.log('üéÆ Simulando palabra v√°lida:', word);
            const simulationResult = document.getElementById('simulation-result');
            simulationResult.innerHTML = '<span style="color: #17a2b8;">üîÑ Simulando palabra v√°lida...</span>';
            
            // Limpiar timeline
            clearTimeline();
            
            // Simular proceso de validaci√≥n
            setTimeout(() => {
                // Calcular puntuaci√≥n simulada
                const score = word.length + Math.floor(Math.random() * 10) + 5;
                gameState.score += score;
                gameState.wordCount++;
                
                // Actualizar display de puntuaci√≥n
                document.getElementById('score-display').textContent = gameState.score;
                
                // Simular audio de palabra correcta
                console.log('üîä Reproduciendo audio de palabra correcta...');
                if (typeof playAudio === 'function') {
                    playAudio('correct_word');
                    updateTimeline('audio-correct', 'Audio CorrectWord.mp3 reproducido', 'success');
                }
                
                // Mostrar resultado
                simulationResult.innerHTML = `
                    <span style="color: #28a745;">‚úÖ Palabra "${word}" v√°lida! +${score} puntos</span><br>
                    <small>Total de palabras: ${gameState.wordCount} | Puntuaci√≥n total: ${gameState.score}</small>
                `;
                
                // Simular reposici√≥n de fichas
                setTimeout(() => {
                    console.log('üß© Reponiendo fichas del jugador');
                    updateTimeline('replenish-tiles', 'Fichas repuestas', 'success');
                }, 500);
                
                // Simular delay de 2 segundos antes del turno
                setTimeout(() => {
                    console.log('‚è±Ô∏è Esperando 2 segundos antes de mostrar el turno del siguiente jugador...');
                    updateTimeline('delay-start', 'Iniciando delay de 2 segundos', 'warning');
                    
                    // Mostrar countdown
                    showCountdown();
                    
                    // Despu√©s de 2 segundos, cambiar turno
                    setTimeout(() => {
                        console.log('üîÑ Pasando al siguiente jugador despu√©s del delay...');
                        updateTimeline('delay-end', 'Delay completado, cambiando turno', 'success');
                        
                        // Cambiar turno
                        gameState.currentPlayer = gameState.currentPlayer === 0 ? 1 : 0;
                        console.log(`üë§ Turno cambiado a: Jugador ${gameState.currentPlayer + 1}`);
                        
                        // Simular audio PlayerTurn.mp3
                        if (typeof playAudio === 'function') {
                            playAudio('player_turn');
                            updateTimeline('audio-turn', 'Audio PlayerTurn.mp3 reproducido', 'success');
                        }
                        
                        simulationResult.innerHTML += `<br><span style="color: #6f42c1;">üîÑ Turno cambiado a: Jugador ${gameState.currentPlayer + 1}</span>`;
                        hideCountdown();
                        
                        // Limpiar input
                        wordInput.value = '';
                        
                        console.log('‚úÖ Simulaci√≥n completada con delay');
                    }, 2000);
                    
                }, 1000);
                
            }, 500);
        }
        
        // Funci√≥n para mostrar countdown
        function showCountdown() {
            const countdown = document.getElementById('countdown');
            const countdownValue = document.getElementById('countdown-value');
            countdown.style.display = 'block';
            
            let seconds = 2;
            countdownValue.textContent = seconds;
            
            const countdownInterval = setInterval(() => {
                seconds--;
                countdownValue.textContent = seconds;
                
                if (seconds <= 0) {
                    clearInterval(countdownInterval);
                }
            }, 1000);
        }
        
        // Funci√≥n para ocultar countdown
        function hideCountdown() {
            const countdown = document.getElementById('countdown');
            countdown.style.display = 'none';
        }
        
        // Funci√≥n para actualizar el timeline
        function updateTimeline(id, action, status) {
            const timelineContent = document.getElementById('timeline-content');
            const timelineItem = document.createElement('div');
            timelineItem.className = `timeline-item ${status === 'success' ? 'active' : status === 'warning' ? 'delayed' : ''}`;
            timelineItem.id = id;
            
            const time = new Date().toLocaleTimeString();
            timelineItem.innerHTML = `
                <div class="timeline-time">${time}</div>
                <div class="timeline-action">${action}</div>
                <div class="timeline-status status-${status}">${status === 'success' ? 'Completado' : status === 'warning' ? 'En Proceso' : 'Info'}</div>
            `;
            
            timelineContent.appendChild(timelineItem);
        }
        
        // Funci√≥n para limpiar el timeline
        function clearTimeline() {
            const timelineContent = document.getElementById('timeline-content');
            timelineContent.innerHTML = `
                <div class="timeline-item">
                    <div class="timeline-time">0s</div>
                    <div class="timeline-action">Inicio de la prueba</div>
                    <div class="timeline-status status-info">Listo</div>
                </div>
            `;
        }
        
        // Verificar configuraci√≥n al cargar
        window.onload = function() {
            console.log('üöÄ P√°gina de prueba de delay del turno cargada');
            
            const configStatus = document.getElementById('config-status');
            
            if (typeof GAME_CONFIG === 'undefined') {
                configStatus.innerHTML = '<span style="color: #dc3545;">‚ùå GAME_CONFIG no est√° definido</span>';
                return;
            }
            
            if (typeof playAudio === 'undefined') {
                configStatus.innerHTML = '<span style="color: #dc3545;">‚ùå Funci√≥n playAudio no est√° disponible</span>';
                return;
            }
            
            configStatus.innerHTML = `
                <span style="color: #28a745;">‚úÖ Configuraci√≥n cargada correctamente</span><br>
                <strong>Audio CorrectWord:</strong> ${GAME_CONFIG.AUDIO.CORRECT_WORD}<br>
                <strong>Audio PlayerTurn:</strong> ${GAME_CONFIG.AUDIO.PLAYER_TURN}<br>
                <strong>Delay del Turno:</strong> 2 segundos implementado<br>
                <strong>Secuencia:</strong> Palabra v√°lida ‚Üí Delay 2s ‚Üí Turno siguiente
            `;
            
            console.log('‚úÖ Configuraci√≥n verificada');
            console.log('GAME_CONFIG:', GAME_CONFIG);
            console.log('Funci√≥n playAudio:', typeof playAudio);
            console.log('Delay del turno: 2 segundos implementado');
        };
        
        // Permitir presionar Enter para simular palabra
        document.getElementById('word-input').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                simulateValidWord();
            }
        });
    </script>
</body>
</html>
